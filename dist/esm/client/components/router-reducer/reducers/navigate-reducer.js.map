{"version":3,"sources":["../../../../../src/client/components/router-reducer/reducers/navigate-reducer.ts"],"names":["CacheStates","fetchServerResponse","createHrefFromUrl","invalidateCacheBelowFlightSegmentPath","fillCacheWithDataProperty","createOptimisticTree","applyRouterStatePatchToTree","shouldHardNavigate","isNavigatingToNewRootLayout","PrefetchKind","handleMutable","applyFlightData","PrefetchCacheEntryStatus","getPrefetchEntryCacheStatus","prunePrefetchCache","prefetchQueue","handleExternalUrl","state","mutable","url","pendingPush","previousTree","tree","mpaNavigation","canonicalUrl","scrollableSegments","undefined","generateSegmentsFromPatch","flightRouterPatch","segments","segment","parallelRoutes","Object","keys","length","parallelRouteKey","parallelRoute","entries","childSegment","push","addRefetchToLeafSegments","newCache","currentCache","flightSegmentPath","treePatch","data","appliedPatch","status","READY","subTreeData","Map","segmentPathsToFill","map","segmentPaths","res","bailOptimistic","navigateReducer","action","isExternalUrl","navigateType","cache","forceOptimisticNavigation","shouldScroll","pathname","hash","href","prefetchCache","isForCurrentTree","JSON","stringify","preserveCustomHistoryState","toString","prefetchValues","get","kind","TEMPORARY","split","optimisticTree","temporaryCacheNode","fetchResponse","nextUrl","buildId","optimisticFlightSegmentPath","slice","flat","patchedTree","hashFragment","set","prefetchTime","Date","now","treeAtTimeOfPrefetch","lastUsedTime","process","env","NODE_ENV","AUTO","newPrefetchValue","prefetchEntryCacheStatus","bump","then","flightData","canonicalUrlOverride","postponed","currentTree","flightDataPath","flightSegmentPathWithLeadingEmpty","newTree","applied","reusable","stale","hardNavigate","subSegment","scrollableSegmentPath"],"mappings":"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"}